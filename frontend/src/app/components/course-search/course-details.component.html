<div
  *ngIf="courseDetails$ | async as courseDetails"
  class="container mx-auto px-16 py-8"
>
  <div class="flex gap-4">
    <!-- left column -->
    <div class="flex-grow w-2/3">
      <div class="text-4xl font-bold" [ngClass]="{'show-title': isScrolled, 'course-title-placeholder': !isScrolled}">{{ courseDetails.title }}</div>

      <h2 class="text-2xl">{{ courseDetails.headline }}</h2>
      <div class="flex justify-between items-center mt-4">
        <p class="text-lg">Instructor: {{ courseDetails.instructor }}</p>
        <img
          [src]="'assets/' + getPlatformLogo(courseDetails.platform)"
          alt="{{ courseDetails.platform }}"
          class="max-h-8 mr-8"
        />
      </div>

      <!-- Curriculum Table -->
      <div class="mt-4">
        <h3 class="text-xl font-semibold">Curriculum</h3>
        <div class="overflow-auto max-h-[500px]">
          <table class="table w-full mt-2">
            <!-- head -->
            <thead>
              <tr>
                <th>
                </th>
                <th class="text-black text-lg ">Section</th>
                <th class="text-black text-lg">Description</th>
                <th class="text-black text-lg text-center">Completed</th>
              </tr>
            </thead>
            <tbody>
              <!-- rows for each curriculum item -->
              <tr *ngFor="let item of courseDetails.curriculum">
                <td>
                  <label>
                    <input type="checkbox" class="checkbox checkbox-secondary" />
                  </label>
                </td>
                <td>{{ item.lectureNumber }}</td>
                <td>{{ item.title }}</td>
                <td class="text-center">
                  <div *ngIf="item.completed; else notCompleted">
                    Yes
                  </div>
                  <ng-template #notCompleted>No</ng-template>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      

      <!-- course notes -->
      <div *ngIf="isUserEnrolled$ | async" class="mt-6">
        <h3 class="text-xl font-semibold">Course Notes</h3>
        <form [formGroup]="courseForm" (ngSubmit)="saveNote()">
          <textarea formControlName="newNote" class="w-full p-2 border" placeholder="Add a note..."></textarea>
          <button type="submit" class="btn btn-primary mt-2">Save Note</button>
        </form>
  
        <div *ngIf="courseNotes$ | async as courseNotes">
          <div *ngFor="let note of courseNotes" class="mt-2 p-2 border">
            {{ note.text }}
          </div>
        </div>
      </div>

    </div>

    <!-- right column -->
    <div class="w-1/3 sticky-column top-0">
      <img
        [src]="courseDetails.imageUrl"
        alt="Course Image"
        class="w-auto max-h-64"
      />
      <!-- button -->
      <ng-container *ngIf="isUserEnrolled$ | async; else notEnrolled">
        <div class="mt-4 w-full bg-green-100 text-green-800 py-2 rounded-md text-bold text-center">
          Enrolled
        </div>
      </ng-container>
      <ng-template #notEnrolled>
        <button (click)="addCourseToList(courseDetails)" class="mt-4 w-full btn btn-accent text-base-100 py-2 rounded-md">
          Add to Course List
        </button>
      </ng-template>
      <a
        [href]="courseDetails.urlToCourse"
        target="_blank"
        rel="noopener noreferrer"
        class="mt-4 w-full inline-block text-center btn btn-secondary text-white py-2 rounded-md"
        style="padding-top: 15px; padding-bottom: 10px"
      >
        View on {{ displayPlatformName(courseDetails.platform) }}
      </a>
    </div>
  </div>
</div>
<div *ngIf="showSuccessNotification" role="alert" class="alert alert-success">
  <div class="toast toast-top toast-center">
    <div class="alert alert-success">
      <span>Course added successfully!</span>
    </div>
  </div>
</div>
<div *ngIf="showAddFailNotification" role="alert" class="alert alert-info">
  <div class="toast toast-top toast-center">
    <div class="alert alert-info">
      <span>You've already added this course</span>
    </div>
  </div>
</div>
